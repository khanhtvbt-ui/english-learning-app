<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ứng dụng học tiếng Anh cho trẻ em</title>
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
  <style>
    body {
      font-family: 'Inter', sans-serif;
      background-color: #f0f4f8;
    }
    .main-content {
      min-height: calc(100vh - 120px);
      padding-bottom: 80px;
    }
    .footer {
      height: 80px;
      position: relative;
      bottom: 0;
      width: 100%;
    }
    .volume-button {
      position: fixed;
      top: 1rem;
      right: 1rem;
      z-index: 100;
    }
    .liquid-glass-card {
      background-color: rgba(255, 255, 255, 0.4);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.2);
    }
    .game-icon {
      filter: drop-shadow(0 4px 6px rgba(0, 0, 0, 0.1));
    }
  </style>
</head>
<body>

<div id="root"></div>

<script type="text/babel">
const { useState, useEffect, useRef } = React;
const { createRoot } = ReactDOM;

// API key for Gemini models
const apiKey = "";
const ttsApiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-tts:generateContent?key=${apiKey}`;

// Sound effect URLs. Using new, reliable, and child-friendly URLs.
const backgroundMusicUrl = 'https://s3-us-west-2.amazonaws.com/s.cdpn.io/3/gentle-breeze.mp3';
const clickSoundUrl = 'https://s3-us-west-2.amazonaws.com/s.cdpn.io/3/click.mp3';
const correctSoundUrl = 'https://s3-us-west-2.amazonaws.com/s.cdpn.io/3/correct.mp3';
const incorrectSoundUrl = 'https://s3-us-west-2.amazonaws.com/s.cdpn.io/3/correct.mp3';

// Data mock for lessons and games
const lessonsData = {
  basic: [
    {
      id: 1,
      title: { vi: 'BÀI 1: BẢNG CHỮ CÁI', en: 'LESSON 1: ALPHABET' },
      description: { vi: 'Học cách nhận biết và phát âm các chữ cái tiếng Anh.', en: 'Learn to recognize and pronounce English letters.' },
      content: [
        { type: 'text', value: { vi: 'HÃY CÙNG HỌC BẢNG CHỮ CÁI NHÉ!', en: 'LET\'S LEARN THE ALPHABET!' } },
        { type: 'quiz', value: { question: { vi: 'Chữ cái A phát âm thế nào?', en: 'How is the letter A pronounced?' }, options: ['/aː/', '/eɪ/'], correct: '/eɪ/' } },
        { type: 'pronunciation', value: { word: 'apple', text: { vi: 'Đây là quả táo. Apple.', en: 'This is an apple. Apple.' } } }
      ],
      iconSvg: `
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100">
          <defs>
            <linearGradient id="alphabetGradient" x1="0%" y1="0%" x2="100%" y2="100%">
              <stop offset="0%" style="stop-color:#82B1FF;stop-opacity:1" />
              <stop offset="100%" style="stop-color:#3E7AFF;stop-opacity:1" />
            </linearGradient>
            <filter id="shadow">
              <feDropShadow dx="0" dy="5" stdDeviation="5" flood-color="#000" flood-opacity="0.2"/>
            </filter>
          </defs>
          <path d="M50 10 L80 90 H70 L50 35 L30 90 H20 L50 10 Z M45 45 L55 45 L62.5 70 L37.5 70 L45 45 Z" fill="url(#alphabetGradient)" filter="url(#shadow)"/>
        </svg>
      `
    },
    {
      id: 2,
      title: { vi: 'BÀI 2: CÁC CON SỐ', en: 'LESSON 2: NUMBERS' },
      description: { vi: 'Học cách đếm từ 1 đến 10.', en: 'Learn to count from 1 to 10.' },
      content: [
        { type: 'text', value: { vi: 'HÃY CÙNG ĐẾM NÀO! ONE, TWO, THREE...', en: 'LET\'S COUNT! ONE, TWO, THREE...' } },
        { type: 'quiz', value: { question: { vi: 'Số 3 trong tiếng Anh là gì?', en: 'What is the number 3 in English?' }, options: ['two', 'three', 'four'], correct: 'three' } },
        { type: 'pronunciation', value: { word: 'three', text: { vi: 'Đây là số ba. Three.', en: 'This is the number three. Three.' } } }
      ],
      iconSvg: `
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100">
          <defs>
            <linearGradient id="numbersGradient" x1="0%" y1="0%" x2="100%" y2="100%">
              <stop offset="0%" style="stop-color:#82B1FF;stop-opacity:1" />
              <stop offset="100%" style="stop-color:#3E7AFF;stop-opacity:1" />
            </linearGradient>
            <filter id="shadow">
              <feDropShadow dx="0" dy="5" stdDeviation="5" flood-color="#000" flood-opacity="0.2"/>
            </filter>
          </defs>
          <rect x="20" y="5" rx="10" width="60" height="25" fill="url(#numbersGradient)" filter="url(#shadow)"/>
          <text x="50" y="24" text-anchor="middle" font-family="Inter" font-size="20" fill="white">1</text>
          <rect x="20" y="37.5" rx="10" width="60" height="25" fill="url(#numbersGradient)" filter="url(#shadow)"/>
          <text x="50" y="56.5" text-anchor="middle" font-family="Inter" font-size="20" fill="white">2</text>
          <rect x="20" y="70" rx="10" width="60" height="25" fill="url(#numbersGradient)" filter="url(#shadow)"/>
          <text x="50" y="89" text-anchor="middle" font-family="Inter" font-size="20" fill="white">3</text>
        </svg>
      `
    },
    {
      id: 3,
      title: { vi: 'BÀI 3: MÀU SẮC', en: 'LESSON 3: COLORS' },
      description: { vi: 'Học cách gọi tên các màu sắc cơ bản.', en: 'Learn to name basic colors.' },
      content: [
        { type: 'text', value: { vi: 'ĐÂY LÀ MÀU ĐỎ. RED!', en: 'THIS IS RED. RED!' } },
        { type: 'quiz', value: { question: { vi: 'Màu xanh lá cây là gì?', en: 'What is green?' }, options: ['red', 'yellow', 'green'], correct: 'green' } },
        { type: 'pronunciation', value: { word: 'green', text: { vi: 'Đây là màu xanh lá cây. Green.', en: 'This is the color green. Green.' } } }
      ],
      iconSvg: `
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100">
          <defs>
            <linearGradient id="colorGradient" x1="0%" y1="0%" x2="100%" y2="100%">
              <stop offset="0%" style="stop-color:#82B1FF;stop-opacity:1" />
              <stop offset="100%" style="stop-color:#3E7AFF;stop-opacity:1" />
            </linearGradient>
            <filter id="shadow">
              <feDropShadow dx="0" dy="5" stdDeviation="5" flood-color="#000" flood-opacity="0.2"/>
            </filter>
          </defs>
          <circle cx="50" cy="50" r="40" fill="url(#colorGradient)" filter="url(#shadow)"/>
          <path d="M50 10 A40 40 0 0 1 50 90 A40 40 0 0 1 50 10 Z" fill="#FFC637"/>
          <path d="M50 10 A40 40 0 0 1 50 90 A40 40 0 0 1 50 10 Z" fill="#93D37F" transform="rotate(120, 50, 50)"/>
          <path d="M50 10 A40 40 0 0 1 50 90 A40 40 0 0 1 50 10 Z" fill="#FF8393" transform="rotate(240, 50, 50)"/>
        </svg>
      `
    },
    {
      id: 4,
      title: { vi: 'BÀI 4: CÁC LOẠI TRÁI CÂY', en: 'LESSON 4: FRUITS' },
      description: { vi: 'Học cách gọi tên các loại trái cây yêu thích.', en: 'Learn to name your favorite fruits.' },
      content: [
        { type: 'text', value: { vi: 'CÙNG HỌC TÊN TRÁI CÂY NHÉ! APPLE, BANANA, ORANGE.', en: 'LET\'S LEARN THE NAMES OF FRUITS! APPLE, BANANA, ORANGE.' } },
        { type: 'quiz', value: { question: { vi: 'Quả chuối tiếng Anh là gì?', en: 'What is banana in English?' }, options: ['apple', 'banana', 'grape'], correct: 'banana' } },
        { type: 'pronunciation', value: { word: 'banana', text: { vi: 'Đây là quả chuối. Banana.', en: 'This is a banana. Banana.' } } }
      ],
      iconSvg: `
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100">
          <defs>
            <linearGradient id="fruitGradient" x1="0%" y1="0%" x2="100%" y2="100%">
              <stop offset="0%" style="stop-color:#82B1FF;stop-opacity:1" />
              <stop offset="100%" style="stop-color:#3E7AFF;stop-opacity:1" />
            </linearGradient>
            <filter id="shadow">
              <feDropShadow dx="0" dy="5" stdDeviation="5" flood-color="#000" flood-opacity="0.2"/>
            </filter>
          </defs>
          <path d="M30 40 Q40 20 60 20 T70 40 T70 60 T50 80 Q30 60 30 40 Z" fill="url(#fruitGradient)" filter="url(#shadow)"/>
          <path d="M30 40 Q40 20 60 20 T70 40 T70 60 T50 80 Q30 60 30 40 Z" fill="#FFD100"/>
          <circle cx="55" cy="45" r="5" fill="#FF911B"/>
          <path d="M40 35 Q45 25 50 30 T55 25 T60 35 T40 35 Z" fill="#B1F47A"/>
        </svg>
      `
    },
    {
      id: 5,
      title: { vi: 'BÀI 5: GIA ĐÌNH', en: 'LESSON 5: FAMILY' },
      description: { vi: 'Học từ vựng về các thành viên trong gia đình.', en: 'Learn vocabulary about family members.' },
      content: [
        { type: 'text', value: { vi: 'HÃY NÓI VỀ GIA ĐÌNH CỦA BẠN. MOM, DAD, BROTHER, SISTER.', en: 'LET\'S TALK ABOUT YOUR FAMILY. MOM, DAD, BROTHER, SISTER.' } },
        { type: 'quiz', value: { question: { vi: 'Mẹ tiếng Anh là gì?', en: 'What is mom in English?' }, options: ['dad', 'mom', 'sister'], correct: 'mom' } },
        { type: 'pronunciation', value: { word: 'family', text: { vi: 'Gia đình. Family.', en: 'Family. Family.' } } },
        { type: 'quiz', value: { question: { vi: 'Cái gì có màu đỏ?', en: 'What is red?' }, options: ['apple', 'banana', 'chair'], correct: 'apple' } }
      ],
      iconSvg: `
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100">
          <defs>
            <linearGradient id="familyGradient" x1="0%" y1="0%" x2="100%" y2="100%">
              <stop offset="0%" style="stop-color:#82B1FF;stop-opacity:1" />
              <stop offset="100%" style="stop-color:#3E7AFF;stop-opacity:1" />
            </linearGradient>
            <filter id="shadow">
              <feDropShadow dx="0" dy="5" stdDeviation="5" flood-color="#000" flood-opacity="0.2"/>
            </filter>
          </defs>
          <path d="M50 50 A20 20 0 1 0 50 50 Z" fill="url(#familyGradient)" filter="url(#shadow)" transform="translate(0, -10)"/>
          <circle cx="50" cy="50" r="10" fill="#fff" filter="url(#shadow)" transform="translate(0, -10)"/>
          <path d="M50 50 A20 20 0 1 0 50 50 Z" fill="url(#familyGradient)" filter="url(#shadow)" transform="translate(-15, 10)"/>
          <circle cx="35" cy="60" r="10" fill="#fff" filter="url(#shadow)" transform="translate(0, -10)"/>
          <path d="M50 50 A20 20 0 1 0 50 50 Z" fill="url(#familyGradient)" filter="url(#shadow)" transform="translate(15, 10)"/>
          <circle cx="65" cy="60" r="10" fill="#fff" filter="url(#shadow)" transform="translate(0, -10)"/>
        </svg>
      `
    }
  ],
  intermediate: [
    {
      id: 6,
      title: { vi: 'BÀI 1: ĐỘNG VẬT HOANG DÃ', en: 'LESSON 1: WILD ANIMALS' },
      description: { vi: 'Tìm hiểu về các loài động vật sống trong tự nhiên.', en: 'Learn about animals that live in the wild.' },
      content: [
        { type: 'text', value: { vi: 'HÃY KHÁM PHÁ THẾ GIỚI ĐỘNG VẬT NHÉ! LION, TIGER, ELEPHANT.', en: 'LET\'S EXPLORE THE ANIMAL WORLD! LION, TIGER, ELEPHANT.' } },
        { type: 'quiz', value: { question: { vi: 'Vua của muôn loài là gì?', en: 'What is the king of animals?' }, options: ['tiger', 'bear', 'lion'], correct: 'lion' } },
        { type: 'pronunciation', value: { word: 'lion', text: { vi: 'Đây là con sư tử. Lion.', en: 'This is a lion. Lion.' } } }
      ],
      iconSvg: `
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100">
          <defs>
            <linearGradient id="animalGradient" x1="0%" y1="0%" x2="100%" y2="100%">
              <stop offset="0%" style="stop-color:#82B1FF;stop-opacity:1" />
              <stop offset="100%" style="stop-color:#3E7AFF;stop-opacity:1" />
            </linearGradient>
            <filter id="shadow">
              <feDropShadow dx="0" dy="5" stdDeviation="5" flood-color="#000" flood-opacity="0.2"/>
            </filter>
          </defs>
          <path d="M50 20 A25 25 0 1 0 50 70 A25 25 0 1 0 50 20 Z" fill="url(#animalGradient)" filter="url(#shadow)"/>
          <path d="M50 20 C60 10 70 20 70 30 C70 40 60 50 50 50 C40 50 30 40 30 30 C30 20 40 10 50 20 Z" fill="#FFC300" filter="url(#shadow)" transform="rotate(45, 50, 50)"/>
          <circle cx="50" cy="50" r="10" fill="#fff" filter="url(#shadow)"/>
          <circle cx="50" cy="50" r="5" fill="#333" transform="rotate(180, 50, 50)"/>
        </svg>
      `
    },
    {
      id: 7,
      title: { vi: 'BÀI 2: CÁC NGHỀ NGHIỆP', en: 'LESSON 2: JOBS' },
      description: { vi: 'Học tên các nghề nghiệp trong tiếng Anh.', en: 'Learn the names of jobs in English.' },
      content: [
        { type: 'text', value: { vi: 'BẠN MUỐN TRỞ THÀNH GÌ? DOCTOR, TEACHER, PILOT.', en: 'WHAT DO YOU WANT TO BE? DOCTOR, TEACHER, PILOT.' } },
        { type: 'quiz', value: { question: { vi: 'Bác sĩ tiếng Anh là gì?', en: 'What is doctor in English?' }, options: ['teacher', 'doctor', 'pilot'], correct: 'doctor' } },
        { type: 'pronunciation', value: { word: 'doctor', text: { vi: 'Đây là bác sĩ. Doctor.', en: 'This is a doctor. Doctor.' } } },
        { type: 'quiz', value: { question: { vi: 'Số 4 trong tiếng Anh là gì?', en: 'What is the number 4 in English?' }, options: ['two', 'four', 'one'], correct: 'four' } }
      ],
      iconSvg: `
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100">
          <defs>
            <linearGradient id="jobGradient" x1="0%" y1="0%" x2="100%" y2="100%">
              <stop offset="0%" style="stop-color:#82B1FF;stop-opacity:1" />
              <stop offset="100%" style="stop-color:#3E7AFF;stop-opacity:1" />
            </linearGradient>
            <filter id="shadow">
              <feDropShadow dx="0" dy="5" stdDeviation="5" flood-color="#000" flood-opacity="0.2"/>
            </filter>
          </defs>
          <path d="M50 10 L70 30 H60 V90 H40 V30 H30 L50 10 Z" fill="url(#jobGradient)" filter="url(#shadow)"/>
          <rect x="45" y="60" width="10" height="20" fill="#fff" filter="url(#shadow)"/>
        </svg>
      `
    },
    {
      id: 8,
      title: { vi: 'BÀI 3: CẢM XÚC', en: 'LESSON 3: EMOTIONS' },
      description: { vi: 'Diễn tả cảm xúc bằng tiếng Anh.', en: 'Express emotions in English.' },
      content: [
        { type: 'text', value: { vi: 'HỌC CÁCH DIỄN TẢ CẢM XÚC! HAPPY, SAD, ANGRY, EXCITED.', en: 'LEARN HOW TO EXPRESS EMOTIONS! HAPPY, SAD, ANGRY, EXCITED.' } },
        { type: 'quiz', value: { question: { vi: 'Từ nào có nghĩa là hạnh phúc?', en: 'Which word means happy?' }, options: ['sad', 'happy', 'angry'], correct: 'happy' } },
        { type: 'pronunciation', value: { word: 'excited', text: { vi: 'Từ này có nghĩa là hào hứng. Excited.', en: 'This word means excited. Excited.' } } }
      ],
      iconSvg: `
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100">
          <defs>
            <linearGradient id="emotionGradient" x1="0%" y1="0%" x2="100%" y2="100%">
              <stop offset="0%" style="stop-color:#82B1FF;stop-opacity:1" />
              <stop offset="100%" style="stop-color:#3E7AFF;stop-opacity:1" />
            </linearGradient>
            <filter id="shadow">
              <feDropShadow dx="0" dy="5" stdDeviation="5" flood-color="#000" flood-opacity="0.2"/>
            </filter>
          </defs>
          <circle cx="50" cy="50" r="40" fill="url(#emotionGradient)" filter="url(#shadow)"/>
          <circle cx="35" cy="40" r="5" fill="#333"/>
          <circle cx="65" cy="40" r="5" fill="#333"/>
          <path d="M30 65 Q50 80 70 65" stroke="#333" stroke-width="5" fill="transparent" stroke-linecap="round"/>
        </svg>
      `
    }
  ]
};

const gamesData = {
  basic: [
    { id: 1, title: { vi: 'TRÒ CHƠI: GHÉP CHỮ', en: 'GAME: LETTER MATCHING' }, description: { vi: 'Nối từ với hình ảnh tương ứng.', en: 'Match words with corresponding images.' },
      iconSvg: `
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100">
          <defs>
            <linearGradient id="puzzleGradient" x1="0%" y1="0%" x2="100%" y2="100%">
              <stop offset="0%" style="stop-color:#82B1FF;stop-opacity:1" />
              <stop offset="100%" style="stop-color:#3E7AFF;stop-opacity:1" />
            </linearGradient>
            <filter id="shadow">
              <feDropShadow dx="0" dy="5" stdDeviation="5" flood-color="#000" flood-opacity="0.2"/>
            </filter>
          </defs>
          <rect x="20" y="20" rx="10" width="60" height="60" fill="url(#puzzleGradient)" filter="url(#shadow)"/>
          <circle cx="50" cy="20" r="10" fill="transparent" stroke="#fff" stroke-width="5" transform="translate(0, -5)"/>
          <rect x="45" y="55" width="10" height="30" fill="white" transform="rotate(-45, 50, 70)" filter="url(#shadow)"/>
        </svg>
      `
    },
    { id: 2, title: { vi: 'TRÒ CHƠI: ĐUỔI HÌNH BẮT CHỮ', en: 'GAME: GUESS THE WORD' }, description: { vi: 'Đoán từ tiếng Anh qua hình ảnh.', en: 'Guess the English word from an image.' },
      iconSvg: `
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100">
          <defs>
            <linearGradient id="imageGradient" x1="0%" y1="0%" x2="100%" y2="100%">
              <stop offset="0%" style="stop-color:#82B1FF;stop-opacity:1" />
              <stop offset="100%" style="stop-color:#3E7AFF;stop-opacity:1" />
            </linearGradient>
            <filter id="shadow">
              <feDropShadow dx="0" dy="5" stdDeviation="5" flood-color="#000" flood-opacity="0.2"/>
            </filter>
          </defs>
          <rect x="15" y="25" rx="10" width="70" height="50" fill="url(#imageGradient)" filter="url(#shadow)"/>
          <circle cx="70" cy="40" r="7" fill="white" filter="url(#shadow)"/>
          <path d="M20 70 L40 50 L60 65 L80 40 V75 H20 Z" fill="white" filter="url(#shadow)"/>
        </svg>
      `
    },
    { id: 3, title: { vi: 'TRÒ CHƠI: TÌM CẶP ĐÔI', en: 'GAME: FIND THE PAIR' }, description: { vi: 'Tìm các cặp thẻ giống nhau.', en: 'Find matching pairs of cards.' },
      iconSvg: `
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100">
          <defs>
            <linearGradient id="cardsGradient" x1="0%" y1="0%" x2="100%" y2="100%">
              <stop offset="0%" style="stop-color:#82B1FF;stop-opacity:1" />
              <stop offset="100%" style="stop-color:#3E7AFF;stop-opacity:1" />
            </linearGradient>
            <filter id="shadow">
              <feDropShadow dx="0" dy="5" stdDeviation="5" flood-color="#000" flood-opacity="0.2"/>
            </filter>
          </defs>
          <rect x="20" y="25" rx="5" width="30" height="50" fill="url(#cardsGradient)" filter="url(#shadow)"/>
          <rect x="50" y="30" rx="5" width="30" height="50" fill="url(#cardsGradient)" transform="translate(5, 5)"/>
        </svg>
      `
    },
    { id: 4, title: { vi: 'TRÒ CHƠI: ĐIỀN TỪ VÀO CHỖ TRỐNG', en: 'GAME: FILL IN THE BLANK' }, description: { vi: 'Hoàn thành câu bằng từ còn thiếu.', en: 'Complete the sentence with the missing word.' },
      iconSvg: `
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100">
          <defs>
            <linearGradient id="writeGradient" x1="0%" y1="0%" x2="100%" y2="100%">
              <stop offset="0%" style="stop-color:#82B1FF;stop-opacity:1" />
              <stop offset="100%" style="stop-color:#3E7AFF;stop-opacity:1" />
            </linearGradient>
            <filter id="shadow">
              <feDropShadow dx="0" dy="5" stdDeviation="5" flood-color="#000" flood-opacity="0.2"/>
            </filter>
          </defs>
          <rect x="20" y="20" rx="10" width="60" height="60" fill="url(#writeGradient)" filter="url(#shadow)"/>
          <rect x="30" y="30" width="40" height="10" fill="#fff"/>
          <rect x="30" y="50" width="40" height="10" fill="#fff"/>
          <rect x="30" y="70" width="20" height="10" fill="#fff"/>
        </svg>
      `
    },
    { id: 5, title: { vi: 'TRÒ CHƠI: KỂ CHUYỆN BẰNG HÌNH ẢNH', en: 'GAME: STORYTELLING' }, description: { vi: 'Sắp xếp hình ảnh để kể một câu chuyện.', en: 'Arrange images to tell a story.' },
      iconSvg: `
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100">
          <defs>
            <linearGradient id="bookGradient" x1="0%" y1="0%" x2="100%" y2="100%">
              <stop offset="0%" style="stop-color:#82B1FF;stop-opacity:1" />
              <stop offset="100%" style="stop-color:#3E7AFF;stop-opacity:1" />
            </linearGradient>
            <filter id="shadow">
              <feDropShadow dx="0" dy="5" stdDeviation="5" flood-color="#000" flood-opacity="0.2"/>
            </filter>
          </defs>
          <path d="M25 20 H75 V80 H25 Z M75 20 A20 20 0 0 1 75 80" fill="url(#bookGradient)" filter="url(#shadow)"/>
          <path d="M25 20 H75 V80 H25 Z M75 20 A20 20 0 0 1 75 80" fill="#fff"/>
          <path d="M30 25 H65 M30 35 H65 M30 45 H55" stroke="#333" stroke-width="2"/>
        </svg>
      `
    },
    { id: 6, title: { vi: 'TRÒ CHƠI: NGHE VÀ NÓI', en: 'GAME: LISTEN AND SPEAK' }, description: { vi: 'Nghe một từ và lặp lại.', en: 'Listen to a word and repeat it.' },
      iconSvg: `
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100">
          <defs>
            <linearGradient id="micGradient" x1="0%" y1="0%" x2="100%" y2="100%">
              <stop offset="0%" style="stop-color:#82B1FF;stop-opacity:1" />
              <stop offset="100%" style="stop-color:#3E7AFF;stop-opacity:1" />
            </linearGradient>
            <filter id="shadow">
              <feDropShadow dx="0" dy="5" stdDeviation="5" flood-color="#000" flood-opacity="0.2"/>
            </filter>
          </defs>
          <rect x="40" y="20" rx="10" width="20" height="40" fill="url(#micGradient)" filter="url(#shadow)"/>
          <path d="M50 60 L40 80 H60 L50 60 Z" fill="url(#micGradient)"/>
          <circle cx="50" cy="50" r="15" fill="#fff" filter="url(#shadow)"/>
          <path d="M50 30 V20" stroke="#fff" stroke-width="5" stroke-linecap="round"/>
        </svg>
      `
    }
  ],
};

const textData = {
  vi: {
    homeTitle: 'Học Tiếng Anh Vui Nhộn',
    homeSubtitle: 'CHỌN MỘT BÀI HỌC ĐỂ BẮT ĐẦU HÀNH TRÌNH KHÁM PHÁ!',
    coursesTitle: 'CÁC KHÓA HỌC',
    basicLevel: 'CẤP ĐỘ CƠ BẢN',
    intermediateLevel: 'CẤP ĐỘ TRUNG CẤP',
    gamesTitle: 'TRÒ CHƠI THEO CẤP ĐỘ',
    backButton: '← QUAY LẠI',
    quizQuestion: '❓',
    pronunciationTitle: 'LUYỆN PHÁT ÂM',
    listenButton: 'NGHE ĐỌC',
    correctFeedback: 'Chính xác! 🎉',
    incorrectFeedback: 'Sai rồi, thử lại nhé! 🧐',
    loadingTTS: 'ĐANG TẢI...',
    gamePlaceholder: 'ĐÂY LÀ KHU VỰC TRÒ CHƠI. TÍNH NĂNG NÀY ĐANG ĐƯỢC PHÁT TRIỂN. XIN VUI LÒNG QUAY LẠI SAU!',
    headerCourses: 'Khóa học',
    headerGames: 'Trò chơi',
    headerSupport: 'Hỗ trợ',
    headerSettings: 'Cài đặt',
    footerDevelopedBy: 'Phát triển bởi',
    settingsTitle: 'CÀI ĐẶT',
    languageSection: 'NGÔN NGỮ',
    languageSelection: 'CHỌN NGÔN NGỮ:',
    languageVietnamese: 'Tiếng Việt',
    languageEnglish: 'English',
    lessonCompleteTitle: 'BÀI HỌC HOÀN THÀNH!',
    lessonCompleteMessage: 'Bạn đã hoàn thành bài học xuất sắc! ⭐',
    nextLessonButton: 'TIẾP TỤC BÀI TIẾP THEO',
    backToHomeButton: 'VỀ TRANG CHỦ'
  },
  en: {
    homeTitle: 'Fun English Learning',
    homeSubtitle: 'CHOOSE A LESSON TO START THE ADVENTURE!',
    coursesTitle: 'COURSES',
    basicLevel: 'BASIC LEVEL',
    intermediateLevel: 'INTERMEDIATE LEVEL',
    gamesTitle: 'GAMES BY LEVEL',
    backButton: '← BACK',
    quizQuestion: '❓',
    pronunciationTitle: 'PRONUNCIATION PRACTICE',
    listenButton: 'LISTEN',
    correctFeedback: 'Correct! 🎉',
    incorrectFeedback: 'Incorrect, try again! 🧐',
    loadingTTS: 'LOADING...',
    gamePlaceholder: 'THIS IS THE GAME AREA. THIS FEATURE IS UNDER DEVELOPMENT. PLEASE CHECK BACK LATER!',
    headerCourses: 'Courses',
    headerGames: 'Games',
    headerSupport: 'Support',
    headerSettings: 'Settings',
    footerDevelopedBy: 'Developed by',
    settingsTitle: 'SETTINGS',
    languageSection: 'LANGUAGE',
    languageSelection: 'SELECT LANGUAGE:',
    languageVietnamese: 'Vietnamese',
    languageEnglish: 'English',
    lessonCompleteTitle: 'LESSON COMPLETE!',
    lessonCompleteMessage: 'You\'ve completed the lesson brilliantly! ⭐',
    nextLessonButton: 'CONTINUE TO NEXT LESSON',
    backToHomeButton: 'BACK TO HOME'
  }
};

// --- Helper Functions ---

const pcmToWav = (pcmData, sampleRate) => {
  const pcm16 = new Int16Array(pcmData);
  const dataLength = pcm16.length * 2;
  const buffer = new ArrayBuffer(44 + dataLength);
  const view = new DataView(buffer);

  let offset = 0;
  function writeString(str) {
    for (let i = 0; i < str.length; i++) {
      view.setUint8(offset++, str.charCodeAt(i));
    }
  }

  // Write WAV header
  writeString('RIFF');
  view.setUint32(offset, 36 + dataLength, true);
  offset += 4;
  writeString('WAVE');
  writeString('fmt ');
  view.setUint32(offset, 16, true);
  offset += 4;
  view.setUint16(offset, 1, true);
  offset += 2;
  view.setUint16(offset, 1, true);
  offset += 2;
  view.setUint32(offset, sampleRate, true);
  offset += 4;
  view.setUint32(offset, sampleRate * 2, true);
  offset += 4;
  view.setUint16(offset, 2, true);
  offset += 2;
  view.setUint16(offset, 16, true);
  offset += 2;
  writeString('data');
  view.setUint32(offset, dataLength, true);
  offset += 4;

  // Write PCM data
  for (let i = 0; i < pcm16.length; i++, offset += 2) {
    view.setInt16(offset, pcm16[i], true);
  }

  return new Blob([view], { type: 'audio/wav' });
};

const Icon = ({ iconSvg }) => {
  return (
    <div className="flex-shrink-0 text-purple-900 w-16 h-16 game-icon" dangerouslySetInnerHTML={{ __html: iconSvg }} />
  );
};

const Header = ({ onNavigate, texts }) => (
  <header className="bg-white shadow-md p-4 flex justify-between items-center fixed top-0 w-full z-50 liquid-glass-card">
    <div className="flex items-center space-x-4">
      <h1 className="text-3xl font-extrabold text-blue-600 cursor-pointer" onClick={() => onNavigate('home')}>
        Kids English
      </h1>
    </div>
    <nav className="space-x-4 hidden sm:block">
      <button onClick={() => onNavigate('home')} className="text-gray-600 font-semibold hover:text-blue-600 transition-colors">
        {texts.headerCourses}
      </button>
      <button onClick={() => onNavigate('home')} className="text-gray-600 font-semibold hover:text-blue-600 transition-colors">
        {texts.headerGames}
      </button>
      <button onClick={() => onNavigate('settings')} className="text-gray-600 font-semibold hover:text-blue-600 transition-colors">
        {texts.headerSettings}
      </button>
    </nav>
  </header>
);

const Footer = ({ texts }) => (
  <footer className="bg-gray-800 text-white p-4 text-center mt-10 footer flex flex-col justify-center items-center">
    <div className="flex items-center justify-center space-x-4 mb-2">
      <img src="https://placehold.co/40x40/FF5733/FFFFFF?text=AV" alt="Avatar" className="rounded-full" />
      <div>
        <h4 className="font-bold text-lg">{texts.footerDevelopedBy}</h4>
        <p className="text-sm text-gray-400">Nguyễn Văn A</p>
      </div>
    </div>
    <p className="text-xs text-gray-500">
      &copy; 2024 Kids English App. All rights reserved.
    </p>
  </footer>
);

const LessonCompleteModal = ({ texts, lesson, onNextLesson, onBackToHome }) => {
  return (
    <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
      <div className="bg-white rounded-2xl p-8 max-w-sm text-center shadow-lg transform scale-100 transition-transform duration-300">
        <div className="text-6xl mb-4 animate-bounce">
          ⭐
        </div>
        <h2 className="text-3xl font-bold text-green-600 mb-2">{texts.lessonCompleteTitle}</h2>
        <p className="text-lg text-gray-800 mb-6">{texts.lessonCompleteMessage}</p>
        <div className="space-y-4">
          <button
            onClick={() => onNextLesson()}
            className="w-full bg-blue-600 text-white py-3 px-6 rounded-full font-semibold text-lg transition-all hover:bg-blue-700 transform hover:scale-105"
          >
            {texts.nextLessonButton}
          </button>
          <button
            onClick={() => onBackToHome()}
            className="w-full bg-gray-300 text-gray-800 py-3 px-6 rounded-full font-semibold text-lg transition-all hover:bg-gray-400 transform hover:scale-105"
          >
            {texts.backToHomeButton}
          </button>
        </div>
      </div>
    </div>
  );
};

const App = () => {
  const [activeScreen, setActiveScreen] = useState('home');
  const [selectedLesson, setSelectedLesson] = useState(null);
  const [selectedGame, setSelectedGame] = useState(null);
  const [feedback, setFeedback] = useState({ message: '', isCorrect: null });
  const [isPlayingBGM, setIsPlayingBGM] = useState(false);
  const [isLoadingTTS, setIsLoadingTTS] = useState(false);
  const [language, setLanguage] = useState('vi');
  const [completedLessons, setCompletedLessons] = useState({});
  const [showCompletionModal, setShowCompletionModal] = useState(false);

  const texts = textData[language];

  // Using useRef to manage audio instances
  const audioRefs = useRef({
    bgm: new Audio(backgroundMusicUrl),
    click: new Audio(clickSoundUrl),
    correct: new Audio(correctSoundUrl),
    incorrect: new Audio(incorrectSoundUrl),
    tts: new Audio(),
  });

  // Effect to preload audio files. BGM will not autoplay.
  useEffect(() => {
    const refs = audioRefs.current;
    refs.bgm.load();
    refs.click.load();
    refs.correct.load();
    refs.incorrect.load();
    
    refs.bgm.loop = true;
    refs.bgm.volume = 0.2;
  }, []);

  const toggleBGM = () => {
    if (isPlayingBGM) {
      audioRefs.current.bgm.pause();
    } else {
      audioRefs.current.bgm.play().catch(e => console.log("Play failed:", e));
    }
    setIsPlayingBGM(!isPlayingBGM);
  };

  const playClickSound = () => {
    audioRefs.current.click.currentTime = 0;
    audioRefs.current.click.play().catch(e => console.log("Click sound play failed:", e));
  };

  const handleLessonCompletion = () => {
    setCompletedLessons(prev => ({
      ...prev,
      [selectedLesson.id]: true
    }));
    setShowCompletionModal(true);
  };

  const handleQuizAnswer = (option, correct) => {
    playClickSound();
    if (option === correct) {
      audioRefs.current.correct.currentTime = 0;
      audioRefs.current.correct.play().catch(e => console.log("Correct sound play failed:", e));
      setFeedback({ message: texts.correctFeedback, isCorrect: true });
      setTimeout(() => {
        setFeedback({ message: '', isCorrect: null });
        handleLessonCompletion();
      }, 1000);
    } else {
      audioRefs.current.incorrect.currentTime = 0;
      audioRefs.current.incorrect.play().catch(e => console.log("Incorrect sound play failed:", e));
      setFeedback({ message: texts.incorrectFeedback, isCorrect: false });
      setTimeout(() => {
        setFeedback({ message: '', isCorrect: null });
      }, 2000);
    }
  };

  const speakText = async (text) => {
    playClickSound();
    setIsLoadingTTS(true);

    const payload = {
      contents: [{
        parts: [{ text: text[language] || text }]
      }],
      generationConfig: {
        responseModalities: ["AUDIO"],
        speechConfig: {
          voiceConfig: {
            prebuiltVoiceConfig: { voiceName: "Erinome" }
          }
        }
      },
      model: "gemini-2.5-flash-preview-tts"
    };

    try {
      const response = await fetch(ttsApiUrl, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(payload)
      });
      if (!response.ok) {
        throw new Error(`API call failed with status: ${response.status}`);
      }
      const result = await response.json();
      const part = result?.candidates?.[0]?.content?.parts?.[0];
      const audioData = part?.inlineData?.data;
      const mimeType = part?.inlineData?.mimeType;

      if (audioData && mimeType && mimeType.startsWith("audio/")) {
        const sampleRateMatch = mimeType.match(/rate=(\d+)/);
        if (sampleRateMatch) {
          const sampleRate = parseInt(sampleRateMatch[1], 10);
          const pcmData = Uint8Array.from(atob(audioData), c => c.charCodeAt(0)).buffer;
          const wavBlob = pcmToWav(pcmData, sampleRate);
          const audioUrl = URL.createObjectURL(wavBlob);
          audioRefs.current.tts.src = audioUrl;
          await audioRefs.current.tts.play();
        } else {
          console.error("Could not find sample rate in mimeType.");
        }
      } else {
        console.error("Invalid audio data format from API.");
      }
    } catch (error) {
      console.error("Error during TTS API call:", error);
    } finally {
      setIsLoadingTTS(false);
    }
  };

  const handleNextLesson = () => {
    playClickSound();
    const allLessons = [...lessonsData.basic, ...lessonsData.intermediate];
    const currentIndex = allLessons.findIndex(lesson => lesson.id === selectedLesson.id);
    if (currentIndex < allLessons.length - 1) {
      setSelectedLesson(allLessons[currentIndex + 1]);
      setActiveScreen('lesson');
    } else {
      setActiveScreen('home');
    }
    setShowCompletionModal(false);
  };

  const handleBackToHome = () => {
    playClickSound();
    setActiveScreen('home');
    setShowCompletionModal(false);
  };

  const renderScreen = () => {
    switch (activeScreen) {
      case 'home':
        return (
          <div className="flex flex-col items-center p-8 bg-gradient-to-br from-blue-200 to-sky-400 min-h-screen pt-24 main-content">
            <h1 className="text-5xl font-extrabold text-white text-center mb-6 drop-shadow-md">
              {texts.homeTitle}
            </h1>
            <p className="text-lg text-white text-center mb-10 drop-shadow-sm">
              {texts.homeSubtitle}
            </p>

            <div className="flex flex-col w-full max-w-4xl space-y-8">
              {/* Phần Khóa học */}
              <div className="rounded-2xl shadow-2xl p-6 liquid-glass-card">
                <h2 className="text-3xl font-bold text-gray-800 mb-4">{texts.coursesTitle}</h2>
                <h3 className="text-xl font-semibold text-gray-600 mb-4">{texts.basicLevel}</h3>
                <div className="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6 mb-8">
                  {lessonsData.basic.map((lesson) => (
                    <div
                      key={lesson.id}
                      className="rounded-xl p-6 cursor-pointer transform hover:scale-105 transition-all duration-300 flex items-center space-x-4 border-2 border-white shadow-2xl liquid-glass-card"
                      onClick={() => {
                        playClickSound();
                        setSelectedLesson(lesson);
                        setActiveScreen('lesson');
                      }}
                    >
                      <Icon iconSvg={lesson.iconSvg} />
                      <div className="text-left">
                        <h3 className="text-xl font-bold text-blue-900 mb-1 flex items-center">
                          {lesson.title[language]}
                          {completedLessons[lesson.id] && <span className="ml-2 text-2xl">⭐</span>}
                        </h3>
                        <p className="text-blue-800 text-sm">{lesson.description[language]}</p>
                      </div>
                    </div>
                  ))}
                </div>
                <h3 className="text-xl font-semibold text-gray-600 mb-4">{texts.intermediateLevel}</h3>
                <div className="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6">
                  {lessonsData.intermediate.map((lesson) => (
                    <div
                      key={lesson.id}
                      className="rounded-xl p-6 cursor-pointer transform hover:scale-105 transition-all duration-300 flex items-center space-x-4 border-2 border-white shadow-2xl liquid-glass-card"
                      onClick={() => {
                        playClickSound();
                        setSelectedLesson(lesson);
                        setActiveScreen('lesson');
                      }}
                    >
                      <Icon iconSvg={lesson.iconSvg} />
                      <div className="text-left">
                        <h3 className="text-xl font-bold text-blue-900 mb-1 flex items-center">
                          {lesson.title[language]}
                          {completedLessons[lesson.id] && <span className="ml-2 text-2xl">⭐</span>}
                        </h3>
                        <p className="text-blue-800 text-sm">{lesson.description[language]}</p>
                      </div>
                    </div>
                  ))}
                </div>
              </div>

              {/* Phần Trò chơi */}
              <div className="rounded-2xl shadow-2xl p-6 liquid-glass-card">
                <h2 className="text-3xl font-bold text-gray-800 mb-4">{texts.gamesTitle}</h2>
                <div className="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6">
                  {gamesData.basic.map((game) => (
                    <div
                      key={game.id}
                      className="rounded-xl p-6 cursor-pointer transform hover:scale-105 transition-all duration-300 flex items-center space-x-4 border-2 border-white shadow-2xl liquid-glass-card"
                      onClick={() => {
                        playClickSound();
                        setSelectedGame(game);
                        setActiveScreen('game');
                      }}
                    >
                      <Icon iconSvg={game.iconSvg} />
                      <div className="text-left">
                        <h3 className="text-xl font-bold text-blue-900 mb-1">{game.title[language]}</h3>
                        <p className="text-blue-800 text-sm">{game.description[language]}</p>
                      </div>
                    </div>
                  ))}
                </div>
              </div>
            </div>
          </div>
        );
      case 'lesson':
        return (
          <div className="flex flex-col p-8 bg-gradient-to-br from-blue-200 to-sky-400 min-h-screen pt-24 main-content">
            <button
              onClick={() => {
                playClickSound();
                setActiveScreen('home');
                setFeedback({ message: '', isCorrect: null });
              }}
              className="absolute top-20 left-4 bg-gray-200 text-gray-700 font-bold py-2 px-4 rounded-full transition-all duration-300 hover:bg-gray-300 z-50"
            >
              {texts.backButton}
            </button>
            <div className="flex flex-col items-center text-center mt-12">
              <Icon iconSvg={selectedLesson.iconSvg} />
              <h1 className="text-4xl font-bold text-white mb-6 drop-shadow-md">{selectedLesson.title[language]}</h1>
              <div className="w-full max-w-2xl rounded-xl p-6 shadow-2xl liquid-glass-card">
                {selectedLesson.content.map((item, index) => (
                  <div key={index} className="mb-4">
                    {item.type === 'text' && (
                      <p className="text-gray-700 text-lg mb-4 font-bold">{item.value[language]}</p>
                    )}
                    {item.type === 'quiz' && (
                      <div className="rounded-xl shadow-2xl p-6 bg-white/40 liquid-glass-card">
                        <p className="text-gray-800 font-bold mb-4">{texts.quizQuestion} {item.value.question[language].toUpperCase()}</p>
                        <div className="grid grid-cols-1 sm:grid-cols-2 gap-4">
                          {item.value.options.map((option, idx) => (
                            <button
                              key={idx}
                              onClick={() => handleQuizAnswer(option, item.value.correct)}
                              className="bg-blue-600 text-white rounded-full py-3 px-6 text-lg font-semibold transform transition-all duration-200 hover:bg-blue-700 hover:scale-105"
                            >
                              {option}
                            </button>
                          ))}
                        </div>
                      </div>
                    )}
                    {item.type === 'pronunciation' && (
                       <div className="rounded-xl shadow-2xl p-6 mt-4 bg-white/40 liquid-glass-card">
                         <h3 className="text-xl font-bold text-gray-800 mb-2">{texts.pronunciationTitle}</h3>
                         <p className="text-gray-700 text-lg mb-4 font-bold">{item.value.word.toUpperCase()}</p>
                         <button
                           onClick={() => speakText(item.value.text)}
                           className="bg-blue-600 text-white rounded-full py-3 px-6 text-lg font-semibold transform transition-all duration-200 hover:bg-blue-700 hover:scale-105"
                           disabled={isLoadingTTS}
                         >
                           {isLoadingTTS ? (
                              <i className="fas fa-spinner fa-spin mr-2"></i>
                            ) : (
                              <i className="fas fa-volume-up mr-2"></i>
                            )}
                             {texts.listenButton}
                         </button>
                       </div>
                    )}
                  </div>
                ))}
              </div>
            </div>
            {/* Hiển thị thông báo phản hồi */}
            {feedback.message && (
              <div className={`fixed bottom-24 left-1/2 -translate-x-1/2 px-6 py-3 rounded-full text-white font-bold text-lg shadow-lg z-50 transition-opacity duration-300 ${feedback.isCorrect ? 'bg-green-500' : 'bg-red-500'}`}>
                {feedback.message}
              </div>
            )}
          </div>
        );
      case 'game':
        return (
          <div className="flex flex-col p-8 bg-gradient-to-br from-blue-200 to-sky-400 min-h-screen pt-24 main-content">
            <button
              onClick={() => {
                playClickSound();
                setActiveScreen('home');
                setSelectedGame(null);
              }}
              className="absolute top-20 left-4 bg-gray-200 text-gray-700 font-bold py-2 px-4 rounded-full transition-all duration-300 hover:bg-gray-300 z-50"
            >
              {texts.backButton}
            </button>
            <div className="flex flex-col items-center text-center mt-12">
              <Icon iconSvg={selectedGame.iconSvg} />
              <h1 className="text-4xl font-bold text-white mb-6 drop-shadow-md">{selectedGame.title[language]}</h1>
              <p className="text-xl text-white mb-4 drop-shadow-sm">
                {selectedGame.description[language]}
              </p>
              <div className="rounded-xl p-6 shadow-2xl max-w-2xl w-full liquid-glass-card">
                <p className="text-gray-700 text-lg font-bold">
                  {texts.gamePlaceholder}
                </p>
              </div>
            </div>
          </div>
        );
      case 'settings':
        return (
          <div className="flex flex-col p-8 bg-gradient-to-br from-blue-200 to-sky-400 min-h-screen pt-24 main-content">
            <button
              onClick={() => {
                playClickSound();
                setActiveScreen('home');
              }}
              className="absolute top-20 left-4 bg-gray-200 text-gray-700 font-bold py-2 px-4 rounded-full transition-all duration-300 hover:bg-gray-300 z-50"
            >
              {texts.backButton}
            </button>
            <div className="flex flex-col items-center text-center mt-12">
              <h1 className="text-4xl font-bold text-white mb-6 drop-shadow-md">{texts.settingsTitle}</h1>
              <div className="rounded-xl p-6 shadow-2xl max-w-2xl w-full liquid-glass-card">
                <h3 className="text-2xl font-bold text-gray-800 mb-4">{texts.languageSection}</h3>
                <p className="text-gray-700 text-lg mb-4">{texts.languageSelection}</p>
                <div className="flex justify-center space-x-4">
                  <button
                    onClick={() => { playClickSound(); setLanguage('vi'); }}
                    className={`px-6 py-2 rounded-full font-bold transition-colors ${language === 'vi' ? 'bg-blue-600 text-white' : 'bg-gray-200 text-gray-700'}`}
                  >
                    {texts.languageVietnamese}
                  </button>
                  <button
                    onClick={() => { playClickSound(); setLanguage('en'); }}
                    className={`px-6 py-2 rounded-full font-bold transition-colors ${language === 'en' ? 'bg-blue-600 text-white' : 'bg-gray-200 text-gray-700'}`}
                  >
                    {texts.languageEnglish}
                  </button>
                </div>
              </div>
            </div>
          </div>
        );
      default:
        return null;
    }
  };

  return (
    <div className="relative">
      <Header onNavigate={setActiveScreen} texts={texts} />
      <div className="container mx-auto">
        {renderScreen()}
      </div>
      <Footer texts={texts} />
      {/* Nút điều chỉnh âm lượng */}
      <button onClick={toggleBGM} className="volume-button p-3 rounded-full bg-white shadow-md text-gray-700">
        <i className={`fas ${isPlayingBGM ? 'fa-volume-up' : 'fa-volume-mute'}`}></i>
      </button>
      {showCompletionModal && (
        <LessonCompleteModal
          texts={texts}
          lesson={selectedLesson}
          onNextLesson={handleNextLesson}
          onBackToHome={handleBackToHome}
        />
      )}
    </div>
  );
};

window.onload = function() {
  const container = document.getElementById('root');
  if (container) {
    const root = createRoot(container);
    root.render(<App />);
  }
};
</script>

</body>
</html>
